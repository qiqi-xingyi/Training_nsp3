name: CNNbLSTM_ESM1b_v2_trial
save_dir: saved/nsp3/CNNbLSTM_ESM1b_v2/
seed: 1234
target_devices: [0]

arch:
  type: CNNbLSTM_ESM1b_Complete
  args:
    init_n_channels: 1280
    out_channels: 32
    cnn_layers: 2
    kernel_size: [129, 257]
    padding: [64, 128]
    n_hidden: 1024
    dropout: 0.5
    lstm_layers: 2
    embedding_args:
      arch: roberta_large
      dropout: 0.0
      attention_dropout: 0.0
      activation_dropout: 0.0
      ffn_embed_dim: 5120
      layers: 33
      attention_heads: 20
      embed_dim: 1280
      max_positions: 1024
      learned_pos: true
      activation_fn: gelu
      use_bert_init: true
      normalize_before: true
      preact_normalize: true
      normalize_after: true
      token_dropout: true
      no_seed_provided: false
      pooler_activation_fn: 'tanh'
      pooler_dropout: 0.0
      checkpoint_transformer_block: false
      untie_weights_roberta: false

    embedding_pretrained: "G:/Train_NSP/NetSurfP-3.0/models/esm1b_t33_650M_UR50S.pt"

data_loader:
  type: NSPDataLoader
  args:
    train_path:
      - "G:/Train_NSP/NetSurfP-3.0/data/nsp2/training_data/Train_HHblits_p66_fp32.npz"
    test_path:
      - "G:/Train_NSP/NetSurfP-3.0/data/nsp2/training_data/CASP12_HHblits_fp32.npz"
      - "G:/Train_NSP/NetSurfP-3.0/data/nsp2/training_data/CB513_HHblits_fp32.npz"
      - "G:/Train_NSP/NetSurfP-3.0/data/nsp2/training_data/TS115_HHblits_fp32.npz"
    dataset_loader: NSPDataOnlyEncoding
    batch_size: 4
    nworkers: 2
    shuffle: true
    validation_split: 0.05

loss: multi_task_loss

metrics:
  metric_ss8: 0
  metric_ss3: 1
  metric_dis_mcc: 2
  metric_dis_fpr: 2
  metric_rsa: 3
  metric_asa: 3
  metric_phi: 4
  metric_psi: 5

optimizer:
  type: Adam
  args:
    lr: 0.0005
    weight_decay: 0

training:
  early_stop: 3
  epochs: 1
  monitor: min val_loss
  save_period: 1
  tensorboard: true

lr_scheduler:
  type: null

augmentation:
  type: sparse_token
  args: {}
